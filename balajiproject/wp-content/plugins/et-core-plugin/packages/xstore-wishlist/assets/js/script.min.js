!function(S){"use strict";etTheme.autoinit.XStoreWishlist=etTheme.XStoreWishlist=function(){var h,u,s,m,n,l,d,c,_,e,p,f,w,i;function x(a,o,r){a<o?S(r[a]).hasClass("processing")||(S(r[a]).trigger("click").addClass("processing"),S(document.body).on("added_to_cart",function(t,e,s,i){i.attr("data-product_id")==S(r[a]).attr("data-product_id")&&(i.removeClass("processing in-process"),x(++a,o,r))})):S(r[a-1]).parent().hasClass("keeper-all-products-buttons")&&S(".et_b_header-wishlist").find("li").unblock()}function g(t,e,s){t<e&&(S(s[t]).hasClass("processing")||S(s[t]).trigger("click",{is_multiple:!0,i:t,max:e,buttons:s}).addClass("processing"))}function v(t,e,s){var i;t<e&&(i=_?"in-process":"processing",S(s[t]).hasClass(i)||S(s[t]).trigger("click",{is_multiple:!0,i:t,max:e,buttons:s}).addClass(i))}function b(){if(s)return s;{S.ajax({url:xstore_wishlist_params.ajaxurl,dataType:"json",method:"POST",data:{cookie_key:u,action:"xstore_get_user_wishlist"},success:function(t){return s=t.products.products.map(t=>JSON.stringify(t))},error:function(){},complete:function(){}});let t=etTheme.getCookie(u);return t?t.split("|"):[]}}function y(){if(s)return s.map(t=>JSON.parse(t).id);{S.ajax({url:xstore_wishlist_params.ajaxurl,dataType:"json",method:"POST",data:{cookie_key:u,action:"xstore_get_user_wishlist"},success:function(t){var e=t.products.products;return s=t.products.products.map(t=>JSON.stringify(t)),e},error:function(){},complete:function(){}});let t=etTheme.getCookie(u);return t?t.split("|").map(t=>JSON.parse(t).id):[]}}function T(t,e={}){t=parseInt(t);var s=b(),i=s.map(t=>JSON.parse(t).id).indexOf(t);-1<i&&(s.splice(i,1),etTheme.setCookie(u,s.join("|")),e.table_row&&(e.table_row.css({position:"relative",zoom:1}),e.table_row.find("td:last-child").block({message:null,overlayCSS:{opacity:.6}}).attr("style",null),_?setTimeout(function(){e.table_row.remove()},1500):(e.table_row.find("td:last-child").unblock(),setTimeout(function(){e.table_row.attr("style",null)},500))),S(document).find("."+h+"[data-id="+t+"]").each(function(){e.table_row||S(this).addClass("processing"),w(S(this),JSON.parse(S(this).attr("data-settings")),"remove")}),e.miniwishlist&&e.liItem.block({message:null,overlayCSS:{opacity:.6}}),xstore_wishlist_params.is_loggedin&&(clearTimeout(m),m=setTimeout(function(){k(s.join("|"))},1500)),e.is_multiple?(e.i++,S(document).trigger("xstore_wishlist/removed_product",[s,t,e.is_multiple,e.i,e.max,e.buttons])):S(document).trigger("xstore_wishlist/removed_product",[s,t]))}function k(t){S.ajax({url:xstore_wishlist_params.ajaxurl,dataType:"json",method:"POST",data:{action:"xstore_update_user_wishlist",cookie_key:u,products:t},success:function(t){},error:function(){},complete:function(){}})}function C(e){S.ajax({url:xstore_wishlist_params.ajaxurl,data:{products:e,products_count:e.length,action:"xstore_wishlist_fragments"},method:"POST",success:function(t){t&&t.fragments&&S.each(t.fragments,function(t,e){S(t).replaceWith(e)}),e.length<1?(S(".et_b_header-wishlist").find(".product_list-popup-footer-wrapper").hide(),_&&c&&S.ajax({url:xstore_wishlist_params.ajaxurl,data:{action:"xstore_empty_wishlist_page"},method:"POST",success:function(t){t&&t.page_content&&(S(document).find("form.xstore-wishlist-form").replaceWith(t.page_content),S(document).find(".xstore-wishlist-share").remove())}})):S(".et_b_header-wishlist").find(".product_list-popup-footer-wrapper").attr("style",null)}})}function a(t,e){t.length&&(e?(t.attr("data-o_id")||t.attr("data-o_id",t.data("id")),t.attr("data-id",e)):void 0!==t.attr("data-o_id")&&t.attr("data-id",t.attr("data-o_id")),i(t,parseInt(e)))}function o(t){void 0!==t.attr("data-o_id")&&(t.attr("data-id",t.attr("data-o_id")),i(t,t.attr("data-o_id")))}"undefined"!=typeof Cookies&&(etTheme.xstore_wishlist={},h="xstore-wishlist",u=xstore_wishlist_params.wishlist_id,s=null,l=n=m=0,d=etTheme.et_global.w_width<etTheme.et_global.mob_header_start||etConfig.layoutSettings.is_mobile?S(".mobile-header-wrapper"):S(".header-wrapper"),c=S("body").hasClass("xstore-wishlist-page"),_=S("body").hasClass("xstore-wishlist-owner"),p=e=0,f=`
        <svg viewBox="0 0 24 22" class="xstore-wishlist-animated-heart">
        <path d="M23 6.6C23 12 17.1 17.5 12 21 6.9 17.5 1 12 1 6.6 1 3.5 3.5 1 6.5 1c2.3 0 4.7 1.5 5.5 3.5.8-2 3.2-3.5 5.5-3.5 3 0 5.5 2.5 5.5 5.6z"></path>
        </svg>`,S.ajax({url:xstore_wishlist_params.ajaxurl,dataType:"json",method:"POST",data:{cookie_key:u,action:"xstore_get_user_wishlist"},success:function(t){s=t.products.products.map(t=>JSON.stringify(t))},error:function(){},complete:function(){}}),S(document).on("click","."+h,function(t,e){t.preventDefault();var s=S(this).attr("data-action"),i=S(this).attr("data-id"),a=S(this).data("settings")||{},o=S(this).hasClass(h+"-redirect"),t=e&&!!e.is_multiple,r={},n=(t&&(r={is_multiple:!0,i:e.i,max:e.max,buttons:e.buttons}),S(this).parents("td"));switch((t||n)&&(r.table_row=S(this).parents("tr")),s){case"add":S(this).addClass("processing"),xstore_wishlist_params.animated_hearts&&(clearTimeout(p),S(this).prepend('<span class="xstore-wishlist-animated-hearts et-icon">'+f+f+f+f+f+"</span>")),w(S(this),a,s);var l,[d,c={}]=[i,r];d=parseInt(d),-1===y().indexOf(d)&&((l=b()).push(JSON.stringify({id:d,time:Math.floor((new Date).getTime()/1e3)})),etTheme.setCookie(u,l.join("|"),xstore_wishlist_params.days_cache),c.table_row&&!_&&(c.table_row.css({position:"relative",zoom:1}),c.table_row.find("td:last-child").block({message:null,overlayCSS:{opacity:.6}}).attr("style",null),c.table_row.find("td:last-child").unblock(),setTimeout(function(){c.table_row.attr("style",null)},500)),xstore_wishlist_params.is_loggedin&&(clearTimeout(m),m=setTimeout(function(){k(l.join("|"))},1500)),S(document).find("."+h+"[data-id="+d+"]").each(function(){S(this).addClass("processing"),w(S(this),JSON.parse(S(this).attr("data-settings")))}),c.is_multiple?(c.i++,S(document).trigger("xstore_wishlist/added_product",[l,d,c.is_multiple,c.i,c.max,c.buttons])):S(document).trigger("xstore_wishlist/added_product",[l,d])),o&&S(this).addClass(h+"-redirect-ready");break;case"remove":o&&S(this).hasClass(h+"-redirect-ready")?window.location.href=xstore_wishlist_params.wishlist_page_url:(_||n||S(this).addClass("processing"),w(S(this),a,s),T(i,r))}}),w=function(t,e,s="add"){"add"==s?(e.removeText&&(t.find(".button-text").text(e.removeText),t.find(".mt-mes").text(e.removeText)),e.iconRemove&&t.find(".et-icon").addClass(e.iconRemove).removeClass(e.iconAdd),t.attr("data-action","remove"),t.attr("href",t.attr("href").replace("add_to_wishlist","remove_wishlist"))):(e.addText&&(t.find(".button-text").text(e.addText),t.find(".mt-mes").text(e.addText)),e.iconAdd&&t.find(".et-icon").addClass(e.iconAdd).removeClass(e.iconRemove),t.attr("data-action","add"),t.attr("href",t.attr("href").replace("remove_wishlist","add_to_wishlist"))),t.removeClass(h+"-redirect-ready"),"add"!=s?setTimeout(function(){t.removeClass("processing in-process"),xstore_wishlist_params.animated_hearts&&t.addClass("xstore-wishlist-has-animation")},300):xstore_wishlist_params.animated_hearts?(clearTimeout(p),p=setTimeout(function(){"add"==s?t.removeClass("xstore-wishlist-has-animation"):t.addClass("xstore-wishlist-has-animation"),t.find(".xstore-wishlist-animated-hearts").remove(),t.removeClass("processing in-process")},1e3)):setTimeout(function(){t.removeClass("processing in-process")},300)},S(document).on("click",".xstore-miniwishlist-remove",function(t){t.preventDefault(),T(S(this).data("id"),{miniwishlist:!0,liItem:S(this).parents("li")})}),S(".xstore-wishlist-table :checkbox").on("click",function(){var t;"product-bulk-select"==S(this).attr("name")?S(this).closest("table").children("tbody").find(":checkbox").prop("checked",S(this).prop("checked")):(t=S(this).closest("tbody").find(":checkbox").filter(":visible:enabled").not(":checked"),S(this).closest("table").children("thead, tfoot").find(":checkbox").prop("checked",function(){return 0===t.length}))}),S(document).on("click",".xstore-wishlist-form .add-all-products",function(t){t.preventDefault(),confirm(xstore_wishlist_params.confirmQuestion)&&(etConfig.ajaxProductAddedNotify.type="alert",(t=S(this).closest(".xstore-wishlist-form").find("table").children("tbody").find(":checkbox").parents("tr").find(".ajax_add_to_cart")).length<1?alert(xstore_wishlist_params.no_products_available):x(0,t.length,t))}),S(document).on("click",".et_b_header-wishlist .add-all-products",function(t){var e;t.preventDefault(),confirm(xstore_wishlist_params.confirmQuestion)&&(etConfig.ajaxProductAddedNotify.type="alert",(e=(t=S(this).parents(".et_b_header-wishlist")).find(".keeper-all-products-buttons .ajax_add_to_cart")).length?(t.find("li").block({message:null,overlayCSS:{opacity:.6}}),x(0,e.length,e)):e.length<1&&alert(xstore_wishlist_params.no_products_available))}),S(".xstore-wishlist-actions").on("click",function(t){t.preventDefault(),etConfig.ajaxProductAddedNotify.type="alert";var e,s=S(this).closest(".xstore-wishlist-form").find("table").children("tbody").find(":checkbox:checked").parents("tr");if(s.length<1)alert(xstore_wishlist_params.no_active_checkbox);else if(confirm(xstore_wishlist_params.confirmQuestion))switch(S(this).parent().find("select").val()){case"add":if((e=s.find(".ajax_add_to_cart")).length<1)return void alert(xstore_wishlist_params.no_products_available);x(0,e.length,e);break;case"add_wishlist":(e=s.find("."+h+'[data-action="add"]')).addClass("in-process"),g(0,e.length,e);break;case"remove":if(e=s.find("."+h+'[data-action="remove"]'),_){let t=S(this).closest(".xstore-wishlist-form").find("table").children("tbody").find("tr");e.length==t.find("."+h).length?(S.each(t,function(){S(this).css({position:"relative",zoom:1}),S(this).find("td:last-child").block({message:null,overlayCSS:{opacity:.6}}).attr("style",null)}),etTheme.setCookie(u,"",0),xstore_wishlist_params.is_loggedin&&k([]),C([])):v(0,e.length,e)}else e.addClass("in-process"),v(0,e.length,e)}}),S(document).on("xstore_wishlist/removed_product",function(t,e,s,i,a,o,r){if(i&&a<o)setTimeout(function(){v(a,o,r)},1700);else if(clearTimeout(l),l=setTimeout(function(){C(e)},700),c&&void 0!==etTheme.quickView&&S(t.target.activeElement).parents(".et-quick-view-wrapper").length){let t=S(document).find(".xstore-wishlist-form ."+h+"[data-id="+s+"]").parents("tr");t.css({position:"relative",zoom:1}),t.find("td:last-child").block({message:null,overlayCSS:{opacity:.6}}).attr("style",null),_?setTimeout(function(){t.remove()},1500):(t.find("td:last-child").unblock(),setTimeout(function(){t.attr("style",null)},500)),etTheme.et_woocommerce.quick_view_opened&&etTheme.closeQuickView()}}),S(document).on("xstore_wishlist/added_product",function(t,i,a,e,s,o,r){if(e&&s<o)setTimeout(function(){g(s,o,r)},1700);else switch(clearTimeout(l),l=setTimeout(function(){C(i)},700),clearTimeout(n),xstore_wishlist_params.notify_type){case"alert":etTheme.notify(etConfig.successfullyAdded);break;case"alert_advanced":S.ajax({url:xstore_wishlist_params.ajaxurl,data:{product_id:a,action:"xstore_get_wishlist_product_info"},method:"POST",success:function(t){var e=S("<a>",{class:"et-notify-image",href:t.product_link,target:"_self"}).html(t.product_image);let s=S("<div>",{class:"et-notify-info"}).html(t.product_title);t=S("<a>",{class:"et-notify-button",href:xstore_wishlist_params.wishlist_page_url}).html(xstore_wishlist_params.view_wishlist);s.append(t[0].outerHTML),etTheme.notify(e[0].outerHTML+s[0].outerHTML,"info",5e3,!0)}});break;case"mini_wishlist":let t=S(d).find(".et_b_header-wishlist.et_element-top-level"),e=S(d).find(".et_b_header-wishlist.et_element-top-level.et-off-canvas .et-mini-content"),s=S(d).find(".et_b_header-wishlist.et_element-top-level.et-off-canvas");s.length&&(etTheme.closeQuickView(),etTheme.showHideElementsOnCanvasActions(!0),etTheme.et_global.deny_link_click=!0,S(".et-mobile-panel-wrapper").addClass("outside")),t.addClass("active"),e.addClass("active"),s.addClass("et-content-shown"),n=setTimeout(function(){t.removeClass("active")},1e3)}}),S(document).on("found_variation","form.variations_form",function(t,e){t=S(t.target).closest(".product").find(".xstore-wishlist-single");t.length&&a(t,e.variation_id)}),S(document).on("reset_data","form.variations_form",function(t){t=S(t.target).closest(".product").find(".xstore-wishlist-single");t.length&&o(t)}),S(document).on("found_variation","div.st-swatch-in-loop",function(t,e){t=S(t.target).closest(".product").find(".xstore-wishlist");t.length&&a(t,e.variation_id)}),S(document).on("reset_data","div.st-swatch-in-loop",function(t){t=S(t.target).closest(".product").find(".xstore-wishlist");t.length&&o(t)}),S(document).on("change",".xstore-wishlist-form .xstore-wishlist-quantity .qty",function(){if(clearTimeout(e),0==S(this).val()){let t=S(this).parents("tr").find("."+h+'[data-action="remove"]');e=setTimeout(function(){t.trigger("click")},1500)}}),i=etTheme.xstore_wishlist.switch_variation_button=function(t,e){-1===y().indexOf(e)?w(t,JSON.parse(t.attr("data-settings")),"remove"):w(t,JSON.parse(t.attr("data-settings")))})}}(jQuery);